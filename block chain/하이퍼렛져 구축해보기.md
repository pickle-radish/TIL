# í•˜ì´í¼ë ›ì ¸ êµ¬ì¶•í•´ë³´ê¸°



- apt update

- apt -y install docker.io (ë„ì»¤ ì„¤ì¹˜)

- docker -v (ë„ì»¤ ë²„ì „í™•ì¸ 18ë²„ì „ ì´ìƒ)

- apt -y install docker-compose (ë„ì»¤ ì»´í¬ì¦ˆ ì„¤ì¹˜)

- docker-compose -v (ë„ì»¤ ì»´í¬ì¦ˆ ë²„ì „ í™•ì¸ 1.17.1)

- apt -y install golang-go (goì„¤ì¹˜)

- go version (1.10.4)

- node ì„¤ì¹˜í•˜ê¸° ìœ„í•´ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ ì†ë ¥

  - curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh | sudo bash

  - ë˜ëŠ” apt install npm
  - npm install n -g

- go env (goìœ„ì¹˜ í™•ì¸)

  - GOPATH="/root/go"
    GOROOT="/usr/lib/go-1.10"

- apt install -y vim

- vi ~/.vimrc

```vimrc
set number    " line í‘œì‹œ
set ai    " auto indent
set si " smart indent
set cindent    " c style indent
set shiftwidth=4    " ìë™ ê³µë°± ì±„ì›€ ì‹œ 4ì¹¸
set tabstop=4    " tabì„ 4ì¹¸ ê³µë°±ìœ¼ë¡œ
set ignorecase    " ê²€ìƒ‰ ì‹œ ëŒ€ì†Œë¬¸ì ë¬´ì‹œ
set hlsearch    " ê²€ìƒ‰ ì‹œ í•˜ì´ë¼ì´íŠ¸
set nocompatible    " ë°©í–¥í‚¤ë¡œ ì´ë™ ê°€ëŠ¥
set fileencodings=utf-8,euc-kr    " íŒŒì¼ ì €ì¥ ì¸ì½”ë”© : utf-8, euc-kr
set fencs=ucs-bom,utf-8,euc-kr    " í•œê¸€ íŒŒì¼ì€ euc-kr, ìœ ë‹ˆì½”ë“œëŠ” ìœ ë‹ˆì½”ë“œ
set bs=indent,eol,start    " backspace ì‚¬ìš©ê°€ëŠ¥
set ruler    " ìƒíƒœ í‘œì‹œì¤„ì— ì»¤ì„œ ìœ„ì¹˜ í‘œì‹œ
set title    " ì œëª© í‘œì‹œ
set showmatch    " ë‹¤ë¥¸ ì½”ë”© í”„ë¡œê·¸ë¨ì²˜ëŸ¼ ë§¤ì¹­ë˜ëŠ” ê´„í˜¸ ë³´ì—¬ì¤Œ
set wmnu    " tab ì„ ëˆŒë €ì„ ë•Œ ìë™ì™„ì„± ê°€ëŠ¥í•œ ëª©ë¡
syntax on    " ë¬¸ë²• í•˜ì´ë¼ì´íŠ¸ on
filetype indent on    " íŒŒì¼ ì¢…ë¥˜ì— ë”°ë¥¸ êµ¬ë¬¸ ê°•ì¡°
set mouse=a    " ì»¤ì„œ ì´ë™ì„ ë§ˆìš°ìŠ¤ë¡œ ê°€ëŠ¥í•˜ë„ë¡

```

- vi .bashrc
  - export GOPAHT="/rrot/go"
    export GOROOT="/usr/lib/go-1.10"
- source .bashrc (goí™˜ê²½ë³€ìˆ˜ ì ìš©)
- echo $GOROOT && echo $GOPATH (ì ìš© ë˜ì—ˆëŠ”ì§€ í™•ì¸)
- mkdir HLF
- cd HLF
- **curl -sSL http://bit.ly/2ysbOFE | bash -s 1.4.3 (****ğŸ¡º****í•˜ì´í¼ë ˆì € íŒ¨ë¸Œë¦­ì„ ì„¤ì¹˜, 2019/8/21 1.4.2 ë²„ì „ ì„¤ì¹˜ë¨,****ğŸ¡º****2019/8/31ì— 1.4.3ë²„ì „ ì„¤ì¹˜ë¨)**

- vi start.sh

```sh
#!/bin/bash
#
# Copyright IBM Corp All Rights Reserved
#
# SPDX-License-Identifier: Apache-2.0
#
# Exit on first error, print all commands.
set -ev

# don't rewrite paths for Windows Git Bash users
export MSYS_NO_PATHCONV=1

docker-compose -f docker-compose.yml down

docker-compose -f docker-compose.yml up -d ca.example.com orderer.example.com peer0.org1.example.com couchdb cli (ğŸ¡¸ ìš”ê¸°ì— ì´ë ‡ê²Œ cli ì¶”ê°€)
docker ps -a

# wait for Hyperledger Fabric to start
# incase of errors when running later commands, issue export FABRIC_START_TIMEOUT=<larger number>
export FABRIC_START_TIMEOUT=10
#echo ${FABRIC_START_TIMEOUT}
sleep ${FABRIC_START_TIMEOUT}

# Create the channel
docker exec -e "CORE_PEER_LOCALMSPID=Org1MSP" -e "CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/users/Admin@org1.example.com/msp" peer0.org1.example.com peer channel create -o orderer.example.com:7050 -c mychannel -f /etc/hyperledger/configtx/channel.tx
# Join peer0.org1.example.com to the channel.
docker exec -e "CORE_PEER_LOCALMSPID=Org1MSP" -e "CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/users/Admin@org1.example.com/msp" peer0.org1.example.com peer channel join -b mychannel.block

```

- ./start.sh
- docker ps (í˜„ì¬ ì‹¤í–‰ë˜ê³ ìˆëŠ” 5ê°œì˜ ì»¨í…Œì´ë„ˆ í™•ì¸ cli ìˆëŠ”ì§€ ê¼­ í™•ì¸)
- docker exec -it cli bash (cli ë„ì»¤ë¡œ ì ‘ì†)
- peer chaincode install -n jes -v 1.0 -p github.com/sacc (ì²´ì¸ì½”ë“œ ì„¤ì¹˜)
  - nodeë¡œ ì„¤ì¹˜í•˜ëŠ” ê²½ìš°
  - peer chaincode install -n jes_cc_node -v 1.0 -l node -p /opt/gopath/src/github.com/chaincode_example02/node/

- peer chaincode instantiate -n jes -v 1.0 -c '{"Args":["a","10"]}' -C mychannel
  - ì„¤ì¹˜ëœ ì²´ì¸ì½”ë“œëŠ” peerì˜ /var/hyperledger/production/chaincodesì—ì„œ í™•ì¸
  - cliì˜ ìœ„ì¹˜ì—ì„œ 
    - peer chaincode list --installed 
    - peer chaincode list --instantiated -C mychannel
- peer chaincode query -n jes -c '{"Args":["get","a"]}' -C mychannel (10ì˜ ê²°ê³¼)
- peer chaincode invoke -n jes -c '{"Args":["set","a","20"]}' -C mychannel (íŠ¸ëœì­ì…˜ ë¸”ë¡ì˜ í¬ê¸°ê°€ ëŠ˜ì–´ë‚¨)
  - ë¸”ë¡ì˜ í¬ê¸°ëŠ” peerì˜ /var/hyperledger/production/ledgersData/chains/chains/mychanne ìœ„ì¹˜ì—ì„œ í™•ì¸
- peer chaincode invoke -n jes -c '{"Args":["set","a","20"]}' -C mychannel (20ì˜ ê²°ê³¼)





## goë§ê³  ë‹¤ë¥¸ ì–¸ì–´ë¡œ ì„¤ì¹˜í•´ë³´ê¸°

- peer chaincode install -n jes_cc_node -v 1.0 -l node -p /opt/gopath/src/github.com/chaincode_example02/node/
- peer chaincode install -n jes_cc_java -v 1.0 -l java -p /opt/gopath/src/github.com/chaincode_example02/java/
- peer chaincode install -n jes_cc_go -v 1.0 -p github.com/chaincode_example02/go/



- docker exec -it peer0.org1.example.com bash (peer0 ìœ¼ë¡œ ì ‘ì†)
-  /var/hyperledger/production/chaincodes (ì„¤ì¹˜ëœ ì²´ì¸ì½”ë“œ í™•ì¸)
- peer chaincode instantiate -C mychannel -n jes_cc_node -l node -v 1.0 -c '{"Args":["init","a","100","b","200"]}'  (ì„¤ì¹˜ëœ node  ì²´ì¸ ì½”ë“œë¥¼ mychannelì— ì—°ê²°)
-  peer chaincode query -C mychannel -n jes_cc_node -c '{"Args":["query","a"]}' (ì¿¼ë¦¬ ë‚ ë ¤ë³´ê¸°)
- peer chaincode invoke -C mychannel -n jes_cc_node -c '{"Args":["invoke","a","b","10"]}' (invokeí•´ë³´ê¸°)
- peer chaincode query -C mychannel -n jes_cc_node -c '{"Args":["query","a"]}' (ì¿¼ë¦¬ ì‹¤í–‰ìœ¼ë¡œ invoke ê²°ê³¼ í™•ì¸)



## ë°”ë€ ì²´ì¸ì½”ë“œ ì—…ë°ì´íŠ¸ í•˜ê¸°

- docker ì»¨í…Œì´ë„ˆì—ì„œ ë‚˜ì™€ ìš°ë¶„íˆ¬ì—ì„œ ì—°ê²°ëœ volum ì„ ì´ìš©í•´ì„œ  chaincodeë³€ê²½
- ë‹¤ì‹œ cliì»¨í…Œì´ë„ˆ ì•ˆìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤
- peer chaincode install -n jes_cc_node -v 1.1 -l node -p /opt/gopath/src/github.com/chaincode_example02/node/ (ë²„ì „ ë³€ê²½)
- peer chaincode **<u>upgrade</u>** -n jes_cc_node -v 1.1 -c '{"Args":["init", "a", "100","b","0"]}' -C mychannel    (install ëŒ€ì‹  upgrade ëª…ë ¹ì–´ ì‚¬ìš©)
- peer chaincode invoke -C mychannel -n jes_cc_node -c '{"Args":["send","a","b","10"]}' 
  (invoke ëª…ë ¹ì–´ ì‹¤í–‰ìœ¼ë¡œ í•¨ìˆ˜ê°€ invokeì—ì„œ sendë¡œ ì˜ ë°”ê¼ˆëŠ”ì§€ í™•ì¸)
- peer chaincode query -C mychannel -n jes_cc_node -c '{"Args":["query","a"]}'
  (ì¿¼ë¦¬ í™•ì¸)









peer chaincode query -c '{"Args":["ownerHistory","CAR0"]}' -C mychannel  -n fabcar5



peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.exampe.com-cert.pem -C mychannel -n fabcar3 -l node -v 1.0 -c '{"Args":[]}'



#### crypto íŒŒì¼ ìƒì„±í•  ë•Œ bin í´ë”ê°€ ì—†ì„ ë•Œ ì‹¤í–‰í•´ì•¼ í•  ëª…ë ¹ì–´

curl -sSL https://goo.gl/6wtTN5 | bash -s 1.1.0

